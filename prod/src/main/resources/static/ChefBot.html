<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ChefBot - Asisten Memasak</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;600&display=swap" rel="stylesheet"/>
  <style>
    body {
      font-family: 'Poppins', sans-serif;
    }

    body.chefbot-page nav a[href="recipe.html"] {
    border-bottom: none !important;
    color: #803f22 !important;
    font-weight: normal !important;
    }

    </style>
</head>


<body class="bg-[#fff8f3] text-gray-800 chefbot-page">
    <nav class="bg-white shadow-md sticky top-0 z-50">
    <div class="container mx-auto px-6 py-4 flex items-center justify-between">

      <div class="flex-shrink-0">
        <h1 class="text-2xl font-bold text-[#803f22] tracking-wide">
          üç¥ Cook<span class="text-orange-500">Pedia</span>
        </h1>
      </div>

      <div class="hidden md:flex flex-grow justify-center space-x-6 items-center text-sm font-medium text-[#803f22]">
        <a href="index.html" class="hover:text-orange-500 transition-all duration-300 active:scale-95">Beranda</a>
        <a href="recipe.html" class="text-orange-500 font-semibold border-b-2 border-orange-500 active:scale-95">Resep</a>
        <a href="guide.html" class="hover:text-orange-500 transition-all duration-300 active:scale-95">Panduan</a>
        <a href="saved.html" class="hover:text-orange-500 transition-all duration-300 active:scale-95">Simpan</a>
      </div>

      <div class="flex-shrink-0" id="userMenu">
        <a href="signin.html" class="bg-gradient-to-r from-[#803f22] to-orange-600 text-white px-4 py-2 rounded-full hover:shadow-lg transition-all duration-300 active:scale-95 flex items-center">
          <span>Masuk</span>
          <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 16l-4-4m0 0l4-4m-4 4h14m-5 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h7a3 3 0 013 3v1"></path>
          </svg>
        </a>
      </div>
      </div>
    </div>
  </nav>

    <!-- Tombol Back yang lebih menonjol -->
    <div class="container mx-auto px-6 py-4">
        <a href="index.html" class="bg-[#803f22] text-white px-4 py-2 rounded-lg hover:bg-[#6a3418] transition-all duration-300 inline-flex items-center">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor">
            <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
        </svg>
        Kembali ke Beranda
        </a>
    </div>

    <section class="container mx-auto px-4 py-12 text-center">
        <h2 class="text-4xl font-bold text-[#803f22] mb-4">Selamat Datang di ChefBot</h2>
        <p class="text-gray-600 text-lg max-w-xl mx-auto">Asisten memasak interaktif yang siap membantu kamu dengan tips memasak, resep, dan jawaban instan atas pertanyaan seputar dapur!</p>
    </section>

    
  <!-- Chat Section -->
  <section class="max-w-3xl mx-auto bg-white rounded-xl shadow-lg p-6 mb-12">
    <h3 class="text-2xl font-semibold mb-4 text-[#803f22]">Mulai Bertanya ke ChefBot</h3>
    
    <!-- Chat Container -->
    <div class="h-80 overflow-y-auto border border-gray-200 rounded-lg p-4 mb-4 bg-gray-50" id="chatBox">
      <div class="text-gray-500 italic">ChefBot siap membantu kamu. Ketik pertanyaanmu di bawah!</div>
    </div>

    <!-- Input Form -->
    <form id="chatForm" class="flex">
      <input type="text" id="userInput" placeholder="Contoh: Bagaimana cara membuat rendang?" class="flex-1 border border-gray-300 rounded-l-lg px-4 py-2 focus:outline-none" />
      <button type="submit" class="bg-[#803f22] text-white px-6 rounded-r-lg hover:bg-[#6a3418] transition">Kirim</button>
    </form>
  </section>

  <footer class="bg-gradient-to-b from-[#803f22] to-[#5a2d18] text-white pt-12 pb-8 slide-up delay-5">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-8">
        <div class="flex flex-col">
          <div class="flex items-center mb-4">
            <span class="text-2xl mr-2">üç¥</span>
            <h3 class="text-2xl font-bold bg-clip-text text-transparent bg-gradient-to-r from-orange-300 to-amber-200">CookPedia</h3>
          </div>
          <p class="text-sm text-orange-100 mb-4 leading-relaxed">
            Temukan inspirasi memasak harian dari resep sederhana hingga favorit keluarga. Jadikan memasak lebih mudah dan menyenangkan!
          </p>
          <div class="mt-auto">
            <p class="text-xs text-orange-200 font-medium">&copy; 2025 CookPedia</p>
          </div>
        </div>

        <div class="md:pl-8">
          <h4 class="text-lg font-semibold mb-4 pb-2 border-b border-orange-300/30">Navigasi Cepat</h4>
          <ul class="grid grid-cols-2 gap-2 text-sm">
            <li><a href="index.html" class="hover:text-orange-300 transition flex items-center py-1">
              <span class="w-1 h-1 bg-orange-300 rounded-full mr-2"></span>Beranda</a></li>
            <li><a href="recipe.html" class="hover:text-orange-300 transition flex items-center py-1">
              <span class="w-1 h-1 bg-orange-300 rounded-full mr-2"></span>Resep</a></li>
            <li><a href="guide.html" class="hover:text-orange-300 transition flex items-center py-1">
              <span class="w-1 h-1 bg-orange-300 rounded-full mr-2"></span>Panduan</a></li>
            <li><a href="ChefBot.html" class="hover:text-orange-300 transition flex items-center py-1">
              <span class="w-1 h-1 bg-orange-300 rounded-full mr-2"></span>Chefbot</a></li>
            <li><a href="saved.html" class="hover:text-orange-300 transition flex items-center py-1">
              <span class="w-1 h-1 bg-orange-300 rounded-full mr-2"></span>Simpan</a></li>
          </ul>
        </div>

        <div class="md:pl-8">
          <h4 class="text-lg font-semibold mb-4 pb-2 border-b border-orange-300/30">Kontak</h4>
          <ul class="space-y-3 text-sm text-orange-100">
            <li class="flex items-start">
              <span class="mr-3 mt-0.5">üìß</span>
              <a href="mailto:info@cookeasy.com" class="hover:text-orange-300">info@cookpedia.com</a>
            </li>
            <li class="flex items-start">
              <span class="mr-3 mt-0.5">üì±</span>
              <a href="https://instagram.com/cookeasy" class="hover:text-orange-300">@cookpedia</a>
            </li>
            <li class="flex items-start">
              <span class="mr-3 mt-0.5">üëç</span>
              <a href="#" class="hover:text-orange-300">CookPedia Official</a>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </footer>

  

  <!-- JavaScript Simulasi Respon -->
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      const userData = localStorage.getItem('cookeasyUser');
      const userMenu = document.getElementById('userMenu');

      if(userData && userMenu) {
        const user = JSON.parse(userData);
        userMenu.innerHTML = `
          <div class="relative group inline-block text-left">
          <button class="bg-[#803f22] text-white px-4 py-2 rounded-md flex items-center justify-between gap-2 hover:bg-[#5c2c14] transition-all duration-300 active:scale-95 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-[#a8552f]">
            <span>Profil</span>
            <svg class="w-5 h-5 transform transition-transform duration-300 group-hover:rotate-180" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7" />
            </svg>
          </button>
          <div class="absolute right-0 mt-3 w-40 origin-top-right bg-white border border-gray-200 rounded-md shadow-lg ring-1 ring-black ring-opacity-5 opacity-0 scale-95 group-hover:opacity-100 group-hover:scale-100 transition-all duration-300 z-50">
            <a href="profile.html" class="block px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-[#803f22] transition-colors">Profil Saya</a>
            <button id="logoutBtn" class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 hover:text-[#803f22] transition-colors">Keluar</button>
          </div>
        </div>
        `;

        document.getElementById('logoutBtn').addEventListener('click', function() {
          const confirmLogout = confirm("Apakah Anda yakin ingin logout?");
          if (confirmLogout) {
            localStorage.removeItem('cookeasyUser');
            location.reload();
          }
        });
      }
    });
    
    const form = document.getElementById('chatForm');
    const input = document.getElementById('userInput');
    const chatBox = document.getElementById('chatBox');

    async function askChefBot(question) {
      try {
        const res = await fetch('/api/chatbot', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ message: question })
        });
        if (!res.ok) throw new Error('Gagal menghubungi ChefBot');
        const data = await res.json();
        return data.reply || "Maaf, ChefBot tidak dapat menjawab saat ini.";
      } catch (e) {
        return "Maaf, terjadi kesalahan saat menghubungi ChefBot.";
      }
    }

    form.addEventListener('submit', async function(e) {
      e.preventDefault();
      const userText = input.value.trim();
      if (!userText) return;

      // Tampilkan pesan pengguna
      const userMsg = `<div class="mb-2 text-right"><span class="bg-[#803f22] text-white px-3 py-1 rounded-lg inline-block">${userText}</span></div>`;
      chatBox.innerHTML += userMsg;
      chatBox.scrollTop = chatBox.scrollHeight;

      // Tampilkan loading
      const loadingMsg = `<div class="mb-4 text-left" id="loadingMsg"><span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-lg inline-block">ChefBot sedang mengetik...</span></div>`;
      chatBox.innerHTML += loadingMsg;
      chatBox.scrollTop = chatBox.scrollHeight;

      input.value = '';
      input.disabled = true;

      // Dapatkan jawaban dari backend (ChatGPT)
      const botReply = await askChefBot(userText);

      // Hapus loading dan tampilkan jawaban
      document.getElementById('loadingMsg').remove();
      const botMsg = `<div class="mb-4 text-left"><span class="bg-gray-200 text-gray-800 px-3 py-1 rounded-lg inline-block">${botReply.replace(/\n/g, '<br>')}</span></div>`;
      chatBox.innerHTML += botMsg;
      chatBox.scrollTop = chatBox.scrollHeight;

      input.disabled = false;
      input.focus();
    });

    input.addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        form.dispatchEvent(new Event('submit'));
      }
    });
  </script>
</body>
</html>
